let state=0,itemList=["Blades","Bludgeons","Unarmed","Throwing","Aim","Magic (Blasting)","Magic (Blighting)","Gadgetry (Destruction)","Gadgetry (Disruption)","Summon","Pilot","Fortitude","Clarity","Armor","Parry","Swiftness","Magic","Gadgetry","Summon","Pilot","Stealth","Performance","Magic","Gadgetry","Medicine","Summon","Perception (Physical)","Perception (Magical)","Perception (Insight)","Provisions","Science","Might","Sleight Of Hand"],auxCount=30;var auxoff=0,auxdef=0,auxsup=0,offPoints=15;const offPointsBase=15,defPointsBase=15,supPointsBase=15;var defPoints=15,supPoints=15,auxPoints=30;let offPointMax=10,defPointMax=10,supPointMax=10,offComb=0,defComb=0,supComb=0;var offSkillID=[],defSkillID=[],supSkillID=[];function engine(e){generateUI();let t=pullID("content"),a=pullID("offenseGrid"),l=pullID("defenseGrid"),o=pullID("supportGrid");pullID("sheet");proceduralUI(a,l,o,t),updateData(),$hr(t),$b(t,"Save Data",function(){save()})}function generateUI(){$d(body,"","content"),$h(3,pullID("header"),"Auxilary points: "+auxCount,"","auxCounter");let e=pullID("content");$form(e,"","sheet");let t=pullID("sheet");$input(t,"Name","sheetData","charName","text","sheetName","Character Name",""),$hr(t,"",""),$input(t,"HP","sheetData","charHP","text","sheetHP","HP","true"),$input(t,"Armor","sheetData","charArmor","text","sheetArm","Armor","true"),$hr(t,"",""),$d(t,"contentGrid","stats");let a=pullID("stats");$d(a,"subGrid","offenseGrid");let l=pullID("offenseGrid");$d(a,"subGrid","defenseGrid");let o=pullID("defenseGrid");$d(a,"subGrid","supportGrid");let n,s=pullID("supportGrid");for($h(3,o,"Defense Points: "+defPoints,"pointCount","defPointCounter"),$h(3,l,"Offense Points: "+offPoints,"pointCount","offPointCounter"),$h(3,s,"Support Points: "+supPoints,"pointCount","supPointCounter"),$hr(t);n<5;n++)$input(t,"fName","","fName"+n,"text","fname1","Feat name"),$input(t,"fInf","","fInf"+n,"text","fname1","Feat name")}function proceduralUI(a,b,c,d){for(let e=0;e<11;e++){$p(a,itemList[e]),$sel(a,"seler","selerOf"+e);let t=pullID("selerOf"+e);offSkillID.push("selerOf"+e);for(let e=0;e<=offPointMax;e++)$opt(t,e,"","");pullID("selerOf"+e).onchange=function(){update("off","selerOf"+e)}}for(let e=0;e<10;e++){$p(b,itemList[e+11]),$sel(b,"seler","selerDe"+e);let t=pullID("selerDe"+e);defSkillID.push("selerDe"+e);for(let e=0;e<=defPointMax;e++)$opt(t,e,"","");pullID("selerDe"+e).onchange=function(){update("def","selerDe"+e)}}for(let e=0;e<12;e++){$p(c,itemList[e+21]),$sel(c,"seler","selerSu"+e);let t=pullID("selerSu"+e);supSkillID.push("selerSu"+e),pullID("selerSu"+e).onchange=function(){update("sup","selerSu"+e)};for(let e=0;e<=supPointMax;e++)$opt(t,e,"","")}$hr(d);for(let e=0;e<5;e++){e%2==0?$d(d,"featDiv","featNo"+e):$d(d,"featDivAlt","featNo"+e);let t=pullID("featNo"+e);$input(t,"","fName","fName"+e,"text","","Feat Name"),$area(t,"","fInfo","fInf"+e,"Feat Info")}$hr(d);for(let i=0;i<5;i++){let divAlta=eval("featNo"+i);i%2==0?$d(divAlta,"featDivStory","featStNo"+i):$d(divAlta,"featDivStoryAlt","featStNo"+i);let divAlt=pullID("featStNo"+i);$input(divAlt,"","fName","fNameSt"+i,"text","","Story Feat Name"),$area(divAlt,"","fInfo","fInfSt"+i,"Story Feat Info")}}function save(){var e=[],t=[],a=[];let l=[],o=[],n=[],s=[];localStorage.setItem("name",pullID("charName").value),localStorage.setItem("hp",pullID("charHP").value),localStorage.setItem("armor",pullID("charArmor").value);for(let t=0;t<11;t++){let a=pullID("selerOf"+[t]).value;e.push(a)}for(let e=0;e<10;e++){let a=pullID("selerDe"+[e]).value;t.push(a)}for(let e=0;e<12;e++){let t=pullID("selerSu"+[e]).value;a.push(t)}for(let e=0;e<5;e++){let t=pullID("fName"+e).value,a=pullID("fInf"+e).value;l.push(t),o.push(a)}for(let e=0;e<5;e++){let t=pullID("fNameSt"+e).value,a=pullID("fInfSt"+e).value;console.log(t),n.push(t),s.push(a)}localStorage.setItem("offense",JSON.stringify(e)),localStorage.setItem("defense",JSON.stringify(t)),localStorage.setItem("support",JSON.stringify(a)),localStorage.setItem("featNames",JSON.stringify(l)),localStorage.setItem("featInfo",JSON.stringify(o)),localStorage.setItem("featNameStory",JSON.stringify(n)),localStorage.setItem("featInfoStory",JSON.stringify(s))}function load(){engine();let e=JSON.parse(localStorage.getItem("offense")),t=JSON.parse(localStorage.getItem("defense")),a=JSON.parse(localStorage.getItem("support")),l=JSON.parse(localStorage.getItem("featNames")),o=JSON.parse(localStorage.getItem("featInfo")),n=JSON.parse(localStorage.getItem("featNameStory")),s=JSON.parse(localStorage.getItem("featInfoStory"));if(null!=e){for(let t=0;t<e.length;t++)pullID("selerOf"+[t]).value=e[t];for(let e=0;e<t.length;e++)pullID("selerDe"+[e]).value=t[e];for(let e=0;e<a.length;e++)pullID("selerSu"+[e]).value=a[e];for(let e=0;e<l.length;e++)pullID("fName"+e).value=l[e];for(let e=0;e<o.length;e++)pullID("fInf"+e).value=o[e];for(let e=0;e<n.length;e++)pullID("fNameSt"+e).value=n[e];for(let e=0;e<s.length;e++)pullID("fInfSt"+e).value=s[e];pullID("charName").value=lo("name")}updateData(),updateAssist("off"),updateAssist("def"),updateAssist("sup")}var num=0;function update(e,t){pullID("defPointCounter"),pullID("supPointCounter");"off"==e&&offPoints+auxPoints>0?updateAssist("off"):"def"==e&&defPoints+auxPoints>0?updateAssist("def"):"sup"==e&&supPoints+auxPoints>0&&updateAssist("sup"),updateData()}function updateData(){val("charHP",Math.floor(val("selerDe0")/2+5)),val("charArmor",val("selerDe2"))}let updateAssist=type=>{var typePoints=eval(type+"Points"),num=0;let data=eval(type+"SkillID");var poinTexBase=eval(type+"PointCounter");for(let e=0;e<data.length;e++){let t=parseInt(pullID(data[e]).value);t<9?num+=t:9==t?num=num+t+1:10==t&&(num=num+t+4)}let pBase=eval(type+"PointsBase"),pnum=pBase-num;if(pBase-num<0){"off"==type?auxoff=Math.abs(pnum):"def"==type?auxdef=Math.abs(pnum):"sup"==type&&(auxsup=Math.abs(pnum));let e=auxoff+auxdef+auxsup,t=auxCount-e;auxPoints=t,typePoints=0,"off"==type?poinTexBase.innerText="Offense Points: "+typePoints:"def"==type?poinTexBase.innerText="Defense Points: "+typePoints:"sup"==type&&(poinTexBase.innerText="Support Points: "+typePoints),pullID("auxCounter").innerText="Auxilary points: "+auxPoints}else{"off"==type?auxoff=0:"def"==type?auxdef=0:"sup"==type&&(auxsup=0),typePoints=pBase-num,"off"==type?poinTexBase.innerText="Offense Points: "+typePoints:"def"==type?poinTexBase.innerText="Defense Points: "+typePoints:"sup"==type&&(poinTexBase.innerText="Support Points: "+typePoints);let e=auxoff+auxdef+auxsup,t=auxCount-e;auxPoints=t,pullID("auxCounter").innerText="Auxilary points: "+auxPoints}auxPoints<0&&(pullID("auxCounter").innerText="Auxilary points: ILLEGAL  ")};function sa(e,t){localStorage.setItem(e,t)}function lo(e){return localStorage.getItem(e)}